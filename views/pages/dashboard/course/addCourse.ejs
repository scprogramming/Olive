<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous">
    <link rel="stylesheet" href="/public/sidebar.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/public/addPage.css">
    
  </head>

  <body>

    <div class="page-container">
      <div class="content-wrap">
          <div class="row">
              <%- include('../navbar.ejs'); %>
          </div>
          <div class="row">
              <div class="col-2">
                  <%- include('../sidebar.ejs'); %>
              </div>
              <div class="col-8">
                <label for="courseTitle" class="col-form-label">Course Title: </label>
                <input type="text" class="form-control" id="courseTitle">         
                <label for="coursePath" class="col-form-label">URL Path: </label>
                <p>/courses/</p> 
                <input type="text" class="form-control" id="coursePath"> 
                <button class="btn btn-primary" onclick="setupCourse()">Save</button>
                <p id = "status"></p>
              </div>
            </div>
      </div>
  </div>

  
</body>
 
<script>

    async function setupCourse(){
            fetch('<%= url %>:<%= port %>/api/addCourse', {
                method:'POST',
                headers: {
                    "Content-Type": "application/json"
                },
                credentials: 'include',
                body:JSON.stringify({title:document.getElementById("courseTitle").value,data:"",page_path:document.getElementById("coursePath").value})
                
            })
            .then(res => redirectId(res));
    }

    async function redirectId(res){
      let result = await res.json();

      if (result.code == -1){
        document.getElementById("status").innerHTML = result.status;
      }else{
        window.location.href = `/dashboard/editCourse/${result.course_id}`;
      }
      
    }


</script>


</html>