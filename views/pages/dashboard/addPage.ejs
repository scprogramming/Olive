<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous">
    <link rel="stylesheet" href="/public/sidebar.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/public/addPage.css">
    
  </head>

  <body>

    <div class="page-container">
      <div class="content-wrap">
          <div class="row">
              <%- include('navbar.ejs'); %>
          </div>
          <div class="row">
              <div class="col-2">
                  <%- include('sidebar.ejs'); %>
              </div>
              <div class="col-8">
                <label for="pageTitle" class="col-form-label">Page Title: </label>
                <input type="text" class="form-control" id="pageTitle">         
                <label for="pagePath" class="col-form-label">URL Path: </label>
                <p>/pages/</p> 
                <input type="text" class="form-control" id="pagePath"> 
                <button class="btn btn-primary" onclick="setupPage()">Save</button>
              </div>
            </div>
      </div>
  </div>

  
</body>
 
<script>

    async function setupPage(){
            fetch('<%= url %>:<%= port %>/api/addPage', {
                method:'POST',
                headers: {
                    "Content-Type": "application/json"
                },
                credentials: 'include',
                body:JSON.stringify({title:document.getElementById("pageTitle").value,data:"",page_path:document.getElementById("pagePath").value})
                
            })
            .then(res => redirectId(res));
    }

    async function redirectId(res){
      let result = await res.json();
      window.location.href = `/dashboard/editPage/${result.page_id}`;
    }

    async function updateId(res){
      let result = await res.json();

      document.getElementById("pageId").innerHTML = result.page_id;
    }

    function savePage(contentTarget,formContent,preview){
        let content = document.getElementById(contentTarget).innerHTML;
        document.getElementById("pageContent").innerHTML += content;

        fetch('<%= url %>:<%= port %>/api/editPage', {
                method:'POST',
                headers: {
                    "Content-Type": "application/json"
                },
                credentials: 'include',
                body:JSON.stringify({page_id:document.getElementById("pageId").innerText, title:"",data:document.getElementById("pageContent").innerHTML})
                
            })

      clearFormPre(formContent,contentTarget);
      

    }

    function clearForm(formContent,previewContent){
      document.getElementById(formContent).reset();
      console.log(previewContent);
      for (let i = 0; i < previewContent.length; i++){
        document.getElementById(previewContent[i]).innerHTML = "";
      }
      
    }

    function updateText(target,textIn){
        document.getElementById(target).innerText = textIn
    }

</script>


</html>